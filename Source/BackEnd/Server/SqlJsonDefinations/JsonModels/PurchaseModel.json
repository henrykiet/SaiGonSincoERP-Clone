{
  "model": "purchase",
  "schema": {
    "partition": false,
    "multiple": true,
    "fields": [
      {
        "name": "purchase_id",
        "property": "purchase_id",
        "type": "string",
        "sqlType": "VARCHAR(50)",
        "primaryKey": true
      },
      {
        "name": "purchase_name",
        "property": "purchase_name",
        "type": "string",
        "sqlType": "NVARCHAR(256)"
      },
      {
        "name": "supplier_id",
        "property": "supplier_id",
        "type": "string",
        "sqlType": "VARCHAR(50)"
      },
      {
        "name": "start_date",
        "property": "start_date",
        "type": "date",
        "sqlType": "SMALLDATETIME"
      },
      {
        "name": "end_date",
        "property": "end_date",
        "type": "date",
        "sqlType": "SMALLDATETIME"
      },
      {
        "name": "note",
        "property": "note",
        "type": "string",
        "sqlType": "NVARCHAR(MAX)"
      },
      {
        "name": "status",
        "property": "status",
        "type": "string",
        "sqlType": "VARCHAR(1)"
      }
    ]
  },
  "excelIntegration": {
    "sheetName": "purchaseReturn",
    "columnMapping": [
      {
        "excelColumn": "Mã bảng giá mua",
        "fieldName": "purchase_id",
        "required": true,
        "hide": false
      },
      {
        "excelColumn": "Tên bảng giá mua",
        "fieldName": "purchase_name",
        "required": true
      },
      {
        "excelColumn": "Nhà cung cấp",
        "fieldName": "supplier_id",
        "required": true,
        "clauseForiegn": "SELECT supplier_id, supplier_name FROM supplier WHERE status = '1'"
      },
      {
        "excelColumn": "Ngày hiệu lực",
        "fieldName": "start_date",
        "type": "date",
        "required": false,
        "hide": true
      },
      {
        "excelColumn": "Ngày hết hiệu lực",
        "fieldName": "end_date",
        "type": "date",
        "required": false,
        "hide": true
      },
      {
        "excelColumn": "Ghi chú",
        "fieldName": "note",
        "required": false
      },
      {
        "excelColumn": "Trạng thái",
        "fieldName": "status",
        "required": false,
        "hide": true
      }
    ],
    "templateRules": {
      "fileFormat": "xlsx",
      "firstRowData": 2,
      "maxRows": 20000
    }
  },
  "checking": {
    "rules": [
      {
        "fieldName": "purchase_name",
        "type": "length",
        "minLength": "1",
        "maxLength": "256",
        "message": "Purchase name is required and maximum 256 characters."
      },
      {
        "fieldName": "purchase_id",
        "type": "databaseCheck",
        "overWrite": true,
        "checkQuery": "WHERE purchase_id = @purchase_id",
        "threshold": "0",
        "message": "Purchase ID already exists in the system."
      }
    ]
  },
  "dataProcessing": {
    "sqlStatements": {}
  },
  "foriegnModel": [
    {
      "model": "purchaseDetail",
      "schema": {
        "partition": false,
        "fields": [
          {
            "name": "purchase_id",
            "property": "purchase_id",
            "type": "string",
            "sqlType": "VARCHAR(50)",
            "primaryKey": true,
            "required":  true
          },
          {
            "name": "line_nbr",
            "property": "line_nbr",
            "type": "number",
            "sqlType": "INT",
            "primaryKey": true,
            "required": true
          },
          {
            "name": "item_id",
            "property": "item_id",
            "type": "string",
            "sqlType": "VARCHAR(50)"
          },
          {
            "name": "item_name",
            "property": "item_name",
            "type": "string",
            "sqlType": "NVARCHAR(256)"
          },
          {
            "name": "unit_id",
            "property": "unit_id",
            "type": "string",
            "sqlType": "VARCHAR(50)"
          },
          {
            "name": "price",
            "property": "price",
            "type": "number",
            "sqlType": "DECIMAL(18,2)"
          },
          {
            "name": "apply_date",
            "property": "apply_date",
            "type": "date",
            "sqlType": "SMALLDATETIME"
          },
          {
            "name": "note",
            "property": "note",
            "type": "string",
            "sqlType": "NVARCHAR(MAX)"
          }
        ]
      },
      "excelIntegration": {
        "sheetName": "purchaseReturnDetail",
        "columnMapping": [
          {
            "excelColumn": "Mã bảng giá mua",
            "fieldName": "purchase_id",
            "required": false,
            "hide": true
          },
          {
            "excelColumn": "STT",
            "fieldName": "line_nbr",
            "required": true
          },
          {
            "excelColumn": "Vật tư",
            "fieldName": "item_id",
            "required": true
          },
          {
            "excelColumn": "Đơn vị tính",
            "fieldName": "unit_id",
            "required": true,
            "clauseForiegn": "SELECT uomCode, uomName FROM uom WHERE status = '1'"
          },
          {
            "excelColumn": "Giá mua (VND)",
            "fieldName": "price",
            "required": true
          },
          {
            "excelColumn": "Ngày áp dụng giá",
            "fieldName": "apply_date",
            "type": "date",
            "required": false,
            "hide": true
          },
          {
            "excelColumn": "Ghi chú",
            "fieldName": "note",
            "required": false
          }
        ],
        "templateRules": {
          "fileFormat": "xlsx",
          "firstRowData": 2,
          "maxRows": 20000
        }
      },
      "checking": {
        "rules": [
          {
            "fieldName": "price",
            "type": "range",
            "min": "0",
            "message": "Price must be greater than or equal to 0."
          }
        ]
      },
      "dataProcessing": {
        "sqlStatements": {}
      }
    }
  ]
}
